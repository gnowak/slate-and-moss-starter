---
// src/pages/guides/[slug].astro
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection, getEntryBySlug } from "astro:content";

export async function getStaticPaths() {
  const guides = await getCollection("guide");
  return guides.map((g) => ({ params: { slug: g.slug } }));
}

const { slug } = Astro.params;
const entry = await getEntryBySlug("guide", slug);
if (!entry) throw new Error(`Guide not found: ${slug}`);

const { Content } = await entry.render(); // <-- only Content comes from render()
const { data } = entry;                   // <-- frontmatter lives here
---

<BaseLayout title={`${data.title} â€” Slate & Moss`} description={data.excerpt}>
  <article class="prose prose-slate max-w-none">
    <h1>{data.title}</h1>
    {data.excerpt && <p class="text-lg text-slateLight">{data.excerpt}</p>}
    <Content />
  </article>
</BaseLayout>
