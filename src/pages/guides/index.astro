---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";
import { Image } from "astro:assets";

const guides = await getCollection("guide", ({ data }) => !data.draft);
---
<BaseLayout title="Guides â€” Slate & Moss">
  <h1 class="text-3xl font-bold mb-6">Guides</h1>
  <div class="grid gap-6 md:grid-cols-2">
    {guides.map(({ slug, data }) => (
      <a href={`/guides/${slug}`} class="card no-underline block overflow-hidden">
        {data.cover && (
          <Image
            src={data.cover}
            alt={data.coverAlt ?? data.title}
            width={800}
            height={400}
            sizes="(max-width: 768px) 100vw, 50vw"
            class="mb-4 rounded-xl w-full h-44 object-cover"
            loading="lazy"
            decoding="async"
          />
        )}
        <p class="kicker">{data.tags?.[0] ?? "Guide"}</p>
        <h2 class="text-xl font-semibold">{data.title}</h2>
        {data.description && <p class="text-sm opacity-80">{data.description}</p>}
      </a>
    ))}
  </div>
</BaseLayout>