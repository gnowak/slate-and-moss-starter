---
import BaseLayout from "../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";
const guides = await getCollection("guide");
---
<BaseLayout title="Guides â€” Slate & Moss">
  <h1 class="text-3xl font-bold mb-6">Guides</h1>
  <div class="grid gap-6 md:grid-cols-2">
    {await Promise.all(guides.map(async (guide) => {
      let coverImg;
      if (guide.data.cover) {
        coverImg = await import(/* @vite-ignore */ guide.data.cover);
      }
      return (
        <a href={`/guides/${guide.slug}`} class="card no-underline block overflow-hidden">
          {coverImg && (
            <img
              src={coverImg.default.src}
              width={coverImg.default.width}
              height={coverImg.default.height}
              alt={guide.data.title}
              class="mb-4 rounded-xl w-full h-44 object-cover"
              loading="lazy"
              decoding="async"
            />
          )}
          <p class="kicker">{guide.data.tags?.[0] ?? "Guide"}</p>
          <h3 class="text-xl font-semibold mb-2">{guide.data.title}</h3>
          <p class="text-sm">{guide.data.excerpt}</p>
        </a>
      );
    }))}
  </div>
</BaseLayout>
